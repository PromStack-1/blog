---
// Animated Layout
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';

interface Props {
	title: string;
	description: string;
}

const { title, description } = Astro.props;
---

<html lang="ko">
	<head>
		<BaseHead title={title} description={description} />
		<style is:global>
			/* Additional layout specific motions */
			.section-fade {
				opacity: 0;
				transform: translateY(40px);
				transition: all 1s cubic-bezier(0.22, 1, 0.36, 1);
			}
			.section-fade.visible {
				opacity: 1;
				transform: translateY(0);
			}
		</style>
	</head>
	<body>
		<!-- Interactive Elements -->
		<div class="cursor-dot" id="cursor-dot"></div>
		<div class="cursor-outline" id="cursor-outline"></div>
		<div class="grid-background" id="grid-bg"></div>

		<Header />
		<slot />
		<Footer />

		<script>
			// 1. Mouse Tracking for Cursor & Grid
			const dot = document.getElementById('cursor-dot');
			const outline = document.getElementById('cursor-outline');
			const gridBg = document.getElementById('grid-bg');

			window.addEventListener('mousemove', (e) => {
				const { clientX, clientY } = e;
				const xPercent = (clientX / window.innerWidth) * 100;
				const yPercent = (clientY / window.innerHeight) * 100;
				
				if (dot && outline) {
					dot.style.left = `${clientX}px`;
					dot.style.top = `${clientY}px`;
					
					outline.animate({
						left: `${clientX}px`,
						top: `${clientY}px`
					}, { duration: 500, fill: 'forwards' });
				}

				if (gridBg) {
					gridBg.style.setProperty('--mouse-x', `${xPercent}%`);
					gridBg.style.setProperty('--mouse-y', `${yPercent}%`);
				}
			});

			// Cursor interaction
			document.querySelectorAll('a, button, .product-card, .bento-item, .post-card').forEach(el => {
				el.addEventListener('mouseenter', () => document.body.classList.add('cursor-active'));
				el.addEventListener('mouseleave', () => document.body.classList.remove('cursor-active'));
			});

			// 2. Scroll Reveal Observer
			const observerOptions = {
				threshold: 0.1
			};

			const revealObserver = new IntersectionObserver((entries) => {
				entries.forEach(entry => {
					if (entry.isIntersecting) {
						entry.target.classList.add('visible');
						revealObserver.unobserve(entry.target);
					}
				});
			}, observerOptions);

			// Init reveal elements
			document.querySelectorAll('.section-fade').forEach(el => revealObserver.observe(el));

			// 3. Card 3D Tilt Effect
			const cards = document.querySelectorAll('.product-card, .bento-item');
			cards.forEach(card => {
				card.addEventListener('mousemove', (e: any) => {
					const rect = card.getBoundingClientRect();
					const x = e.clientX - rect.left;
					const y = e.clientY - rect.top;
					
					const centerX = rect.width / 2;
					const centerY = rect.height / 2;
					
					const rotateX = (y - centerY) / 20;
					const rotateY = (centerX - x) / 20;
					
					(card as HTMLElement).style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
				});
				
				card.addEventListener('mouseleave', () => {
					(card as HTMLElement).style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
				});
			});

			// 4. Smooth Magnetic Buttons
			const magneticBtns = document.querySelectorAll('.btn-primary, .cta-button');
			magneticBtns.forEach(btn => {
				btn.addEventListener('mousemove', (e: any) => {
					const rect = btn.getBoundingClientRect();
					const x = e.clientX - rect.left - rect.width / 2;
					const y = e.clientY - rect.top - rect.height / 2;
					
					(btn as HTMLElement).style.transform = `translate(${x * 0.3}px, ${y * 0.3}px)`;
				});
				
				btn.addEventListener('mouseleave', () => {
					(btn as HTMLElement).style.transform = `translate(0px, 0px)`;
				});
			});
		</script>
	</body>
</html>
